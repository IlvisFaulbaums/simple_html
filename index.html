<h2>Simple Poll</h2>

<button onclick="vote('yes')">Yes</button>
<button onclick="vote('no')">No</button>

<h3 id="results">Loading...</h3>

<script>
const API = "https://api.sarunas.lat"; // <-- your API domain

async function load() {
  try {
    const res = await fetch(API + "/results");
    const data = await res.json();

    let text = "";
    data.forEach(row => {
      text += row.option + ": " + row.count + " | ";
    });

    document.getElementById("results").innerText = text.slice(0, -3);
  } catch (err) {
    document.getElementById("results").innerText = "Error loading results";
  }
}

async function vote(option) {
  try {
    await fetch(API + "/vote", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ option })
    });

    load();
  } catch (err) {
    alert("Error submitting vote");
  }
}

load();
setInterval(load, 2000);
</script>
